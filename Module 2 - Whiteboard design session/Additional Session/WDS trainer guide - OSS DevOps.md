![](https://github.com/Microsoft/MCW-Template-Cloud-Workshop/raw/master/Media/ms-cloud-workshop.png "Microsoft Cloud Workshops")


<div class="MCWHeader1">
OSS DevOps
</div>

<div class="MCWHeader2">
 Whiteboard design session trainer guide
</div>

<div class="MCWHeader3">
December 2018
</div>

Information in this document, including URL and other Internet Web site references, is subject to change without notice. Unless otherwise noted, the example companies, organizations, products, domain names, e-mail addresses, logos, people, places, and events depicted herein are fictitious, and no association with any real company, organization, product, domain name, e-mail address, logo, person, place or event is intended or should be inferred. Complying with all applicable copyright laws is the responsibility of the user. Without limiting the rights under copyright, no part of this document may be reproduced, stored in or introduced into a retrieval system, or transmitted in any form or by any means (electronic, mechanical, photocopying, recording, or otherwise), or for any purpose, without the express written permission of Microsoft Corporation.

Microsoft may have patents, patent applications, trademarks, copyrights, or other intellectual property rights covering subject matter in this document. Except as expressly provided in any written license agreement from Microsoft, the furnishing of this document does not give you any license to these patents, trademarks, copyrights, or other intellectual property.

The names of manufacturers, products, or URLs are provided for informational purposes only and Microsoft makes no representations and warranties, either expressed, implied, or statutory, regarding these manufacturers or the use of the products with any Microsoft technologies. The inclusion of a manufacturer or product does not imply endorsement of Microsoft of the manufacturer or product. Links may be provided to third party sites. Such sites are not under the control of Microsoft and Microsoft is not responsible for the contents of any linked site or any link contained in a linked site, or any changes or updates to such sites. Microsoft is not responsible for webcasting or any other form of transmission received from any linked site. Microsoft is providing these links to you only as a convenience, and the inclusion of any link does not imply endorsement of Microsoft of the site or the products contained therein.
Â© 2018 Microsoft Corporation. All rights reserved.

Microsoft and the trademarks listed at https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/Usage/General.aspx are trademarks of the Microsoft group of companies. All other trademarks are property of their respective owners.

**Contents**

<!-- TOC -->

- [Trainer information](#trainer-information)
  - [Role of the trainer](#role-of-the-trainer)
  - [Whiteboard design session flow](#whiteboard-design-session-flow)
  - [Before the whiteboard design session: How to prepare](#before-the-whiteboard-design-session-how-to-prepare)
  - [During the whiteboard design session: Tips for an effective whiteboard design session](#during-the-whiteboard-design-session-tips-for-an-effective-whiteboard-design-session)
- [OSS DevOps whiteboard design session student guide](#oss-devops-whiteboard-design-session-student-guide)
  - [Abstract and learning objectives](#abstract-and-learning-objectives)
  - [Step 1: Review the customer case study](#step-1-review-the-customer-case-study)
    - [Customer situation](#customer-situation)
    - [Customer needs](#customer-needs)
    - [Customer objections](#customer-objections)
    - [Infographic for common scenarios](#infographic-for-common-scenarios)
  - [Step 2: Design a proof of concept solution](#step-2-design-a-proof-of-concept-solution)
  - [Step 3: Present the solution](#step-3-present-the-solution)
  - [Wrap-up](#wrap-up)
  - [Additional references](#additional-references)
- [OSS DevOps whiteboard design session trainer guide](#oss-devops-whiteboard-design-session-trainer-guide)
  - [Step 1: Review the customer case study](#step-1-review-the-customer-case-study-1)
  - [Step 2: Design a proof of concept solution](#step-2-design-a-proof-of-concept-solution-1)
  - [Step 3: Present the solution](#step-3-present-the-solution-1)
  - [Wrap-up](#wrap-up-1)
  - [Preferred target audience](#preferred-target-audience)
  - [Preferred solution](#preferred-solution)
  - [Checklist of preferred objection handling](#checklist-of-preferred-objection-handling)
  - [Customer quote (to be read back to the attendees at the end)](#customer-quote-to-be-read-back-to-the-attendees-at-the-end)

<!-- /TOC -->


# Trainer information

Thank you for taking time to support the whiteboard design sessions as a trainer!

## Role of the trainer

An amazing trainer:

-   Creates a safe environment in which learning can take place.

-   Stimulates the participant's thinking.

-   Involves the participant in the learning process.

-   Manages the learning process (on time, on topic, and adjusting to benefit participants).

-   Ensures individual participant accountability.

-   Ties it all together for the participant.

-   Provides insight and experience to the learning process.

-   Effectively leads the whiteboard design session discussion.

-   Monitors quality and appropriateness of participant deliverables.

-   Effectively leads the feedback process.

## Whiteboard design session flow 

Each whiteboard design session uses the following flow:

**Step 1: Review the customer case study (15 minutes)**

**Outcome**

Analyze your customer's needs.

-   Customer's background, situation, needs and technical requirements

-   Current customer infrastructure and architecture

-   Potential issues, objectives and blockers

**Step 2: Design a proof of concept solution (60 minutes)**

**Outcome**

Design a solution and prepare to present the solution to the target customer audience in a 15-minute chalk-talk format.

-   Determine your target customer audience.

-   Determine customer's business needs to address your solution.

-   Design and diagram your solution.

-   Prepare to present your solution.

**Step 3: Present the solution (30 minutes)**

**Outcome**

Present solution to your customer:

-   Present solution

-   Respond to customer objections

-   Receive feedback

**Wrap-up (15 minutes)**

-   Review preferred solution

## Before the whiteboard design session: How to prepare

Before conducting your first whiteboard design session:

-   Read the Student guide (including the case study) and Trainer guide.

-   Become familiar with all key points and activities.

-   Plan the point you want to stress, which questions you want to drive, transitions, and be ready to answer questions.

-   Prior to the whiteboard design session, discuss the case study to pick up more ideas.

-   Make notes for later.

## During the whiteboard design session: Tips for an effective whiteboard design session

**Refer to the Trainer guide** to stay on track and observe the timings.

**Do not expect to memorize every detail** of the whiteboard design session.

When participants are doing activities, you can **look ahead to refresh your memory**.

-   **Adjust activity and whiteboard design session pace** as needed to allow time for presenting, feedback, and sharing.

-   **Add examples, points, and stories** from your own experience. Think about stories you can share that help you make your points clearly and effectively.

-   **Consider creating a "parking lot"** to record issues or questions raised that are outside the scope of the whiteboard design session or can be answered later. Decide how you will address these issues, so you can acknowledge them without being derailed by them.

***Have fun**! Encourage participants to have fun and share!*

**Involve your participants.** Talk and share your knowledge but always involve your participants, even while you are the one speaking.

**Ask questions** and get them to share to fully involve your group in the learning process.

**Ask first**, whenever possible. Before launching into a topic, learn your audience's opinions about it and experiences with it. Asking first enables you to assess their level of knowledge and experience, and leaves them more open to what you are presenting.

**Wait for responses**. If you ask a question such as, "What's your experience with (fill in the blank)?" then wait. Do not be afraid of a little silence. If you leap into the silence, your participants will feel you are not serious about involving them and will become passive. Give participants a chance to think, and if no one answers, patiently ask again. You will usually get a response.

#  OSS DevOps whiteboard design session student guide

## Abstract and learning objectives 

In this whiteboard design session, you will design a plan for migrating a Linux based web application to Microsoft Azure that takes advantage of existing open-source software (OSS) skills such as usage of Jenkins. This whiteboard design session will explore options for running Linux, such as virtual machines, or Azure PaaS services, such as Web Apps and Azure Database, for MySQL.

At the end of this whiteboard design session, you will be better able to design solutions that use complex OSS workloads using Azure.

## Step 1: Review the customer case study 

**Outcome**

Analyze your customer's needs.

Timeframe: 15 minutes

Directions: With all participants in the session, the facilitator/SME presents an overview of the customer case study along with technical tips.

1.  Meet your table participants and trainer.

2.  Read all of the directions for steps 1-3 in the student guide.

3.  As a table team, review the following customer case study.

### Customer situation

Trey Research is an online vitamins seller that has a presence mainly in the United Kingdom and other countries/regions in Europe. They want to expand into other parts of the world starting with Asia and will soon be setting up distribution centers for their vitamins there. They have no retail stores and thus all their business comes through their website. SEO (Search Engine Optimization) is extremely important to them as is their user website experience with a heavy focus on availability and performance.

The company currently has two application teams: **Development** for their websites and **Operations** for deployments and backend servers. These are all hosted in a commercial data center. The teams have a great deal of experience in developing applications in PHP and WordPress for the LAMP stack (Linux, Apache, MySQL, and PHP). What they lack is the operational expertise and maturity to maintain their applications properly. They struggle with development and design practices, deployments, configuration management, and scaling their application to meet busy seasonal periods.

**Current situation**

Trey Research is currently running 32 web applications on a single physical 64 core server with 256GB of RAM and a multi-terabyte raid array. To facilitate fast configurations of the server, they are running Plesk which allows them to create and configure new domains rapidly.

These applications are running a combination of PHP, node.js, and WordPress. The application code is written and maintained by the developers in house, but the WordPress content that applies the look and feel to the application is maintained by a marketing firm.

On the Data Tier, Trey Research has a single MySQL database server housing several databases ranging in size from 1 GB to 50 GB. The server has 24 cores with 128GB of RAM, and it is a single point of failure. If the database or the server suffers from an outage, the sites that depend on MySQL go down hard. It is a huge customer satisfaction issue, and there have been multiple extended outages where MySQL was down for more than an hour over the past few months. Every hour the site is down costs Trey Research 100,000 EUR.

During the summer periods or extended marketing campaigns, Trey Research is finding they run out of server capacity, and some of their potential web customers experience timeouts. They also find that much of the static content such as PDF product flyers are taking an extended period to download from more remote regions, such as South East Asia, leading to poor user feedback. As they move into Asia, it is a huge concern, as they do not currently have a point of presence there.

Ursula Karalov, VP of Sales for Trey Research Vitamins states, "We just cannot afford to lose anymore sales due to our website being down or slow." She also mentioned their marketing firm determined a large number of shopping cart abandon rates correlate to slow access (greater than 2 seconds) to PDF product descriptions.

**Development practices and Site Operations**

The CTO, David Smith, wants to enable much faster deployment times for their applications and ensure that all servers in the farm have the same configurations and files deployed. "When we deploy our applications, the team manually FTP's files into our production environment." This process makes it quite difficult and is prone to errors given the different environments maintained including Test, Staging, and Production. Mr. Cross says, "This complexity means that the team is reluctant to rapidly implement hotfixes and minor releases. So right now, we release only once a quarter even when we know there are bugs that could and should be fixed in-line with our three-week sprints and biweekly bug bashes."

The in-house developers primarily use Eclipse for their development IDE. They take advantage of a combination of GitHub repos to store code and a Jenkins server with multiple nodes to do builds. They have yet to implement any deployment pipelines, as they do not have a configuration management infrastructure. It means that once Jenkins does their builds, they are rolled out manually to whichever environment they are destined for and that information is prone to human mistakes and oversights.

On the other hand, the marketing firm writes their code in markdown and provides updates to Trey Research via Dropbox, which has been a huge pain point. "It is just another place for things to get confusing with a complex folder structure that seems to be a moving target," says Tim LaMar, Lead Systems Administrator from Trey Research's Operations. "We have to look for emails from either the Project Manager or their Dev team to know that there is an update coming our way for the site." Tim and the rest of the Operations team must then go find and manually move the code into production. The Operations team is constantly being bombarded with trouble-tickets from the marketing firm for broken links, out of date PDFs, and embargoed code being live on the site when it should not yet be deployed.

Their test environment consists of developers testing code changes locally, as well as checking in changes to a GitHub repository. To deploy, Trey Research just pulls the latest bits onto the production server. It has led to numerous outages because of environmental differences on the developer's workstations versus what is on the production server.

The Trey Research CTO is open to taking advantage of Azure as a platform and wants his team to focus on what they do best, which is to write good code. He knows that the Operations team struggles to find solutions to these issues. "We must get to a point where all we do is code. If Azure and these DevOps tools can come together to make that happen, then I am going with Microsoft."

David has also expressed that if the MySQL database goes down again, it will be a resume generating event for many people on the team including him, so he has a keen interest in having better database availability design.

**Existing [www.treyresearch.com](http://www.treyresearch.com) web application solution**

![At a high level, the Current Environment is split by a firewall between Corp and DMZ. Products used include eclipse, nodeJS, php, W, MySQL, and Jenkins. At this time, we are unable to capture all of the information in the diagram. Future versions of this course should address this.](images/Whiteboarddesignsessiontrainerguide-OSSDevOpsimages/media/image2.png "Current Environment diagram")

###  Customer needs 

1.  Deploy and easily scale their web applications written in PHP, node.js, and WordPress.

2.  A resilient and scalable MySQL backend configured to support an active-passive deployment.

3.  A simpler method of deploying and validating code from their test environment, taking advantage of their investments in Jenkins, Git, and Dropbox.

4.  No longer want to manage a build server environment on-premises.

5.  Ensure that existing Development tools are retained and compatible with any new solution.

6.  Avoid timeouts during busy periods while browsing their product catalog.

7.  Decrease the amount of time needed for remote users in areas like Asia to download graphic-heavy, static content, and product catalogs that are PDFs.

8.  Lower the total cost of ownership of the entire solution by minimizing the management surface area required for the solution.

### Customer objections 

1.  Why use Microsoft Azure? Surely, Azure is a Windows only cloud because Microsoft sells the Windows operating system.

2.  What does Microsoft know about PHP and the LAMP stack? They cannot offer support of these things whereas I know other companies that have successful deployments of this on Amazon

3.  If we move to the cloud, will we always be ready to take our customers' orders?

4.  We have a few settings in our php.ini and some of the applications use PHP extensions. They are critical to their functionality. Can we make custom settings and enable extensions if we use Azure Web Apps?

5.  We primarily use Eclipse for our development, which is what our team uses to debug issues. Can we debug our applications using Eclipse against Azure Web Apps?

6.  We cannot move to Microsoft SQL Server; we do not want to deal with the issues of the MySQL VMs anymore.

### Infographic for common scenarios

![An image that shows icons for virtual machines, virtual networks, marketplace, gateways, CDN, storage and traffic manager.](images/Whiteboarddesignsessiontrainerguide-OSSDevOpsimages/media/image3.png "Common Scenarios")

![An image that shows icons for MySQL, Azure App Service, Web Apps, monitoring and the IDE Eclipse.](images/Whiteboarddesignsessiontrainerguide-OSSDevOpsimages/media/image4.png "Common Scenarios")

## Step 2: Design a proof of concept solution

**Outcome**

Design a solution and prepare to present the solution to the target customer audience in a 15-minute chalk-talk format.

Timeframe: 60 minutes

**Business needs**

Directions:  With all participants at your table, answer the following questions and list the answers on a flip chart:

1.  Who should you present this solution to? Who is your target customer audience? Who are the decision makers?

2.  What customer business needs do you need to address with your solution?

**Design**

Directions: With all participants at your table, respond to the following questions on a flip chart:

**Web app infrastructure and network designs (Operations)**

Using the features of Azure and the requirements from the customer how would you design the application infrastructure and network for Trey Research while lowering the total cost of ownership of the entire solution by designing for the least complexity? Management/updating should be considered for the architecture. The use of VMs should be minimized to lessen the burden of management on the Operations team.

Make sure that your design covers the following items:

**Application**

**Task:** Design a scalable geo-distributed platform for the Trey Research web applications written in PHP, node.js, and WordPress.

1.  The solution should scale automatically and be resilient to failures.

2.  Load times in locations around the world should be lessened as compared to today. Static and large files should be placed as close to the user as possible.

3.  Ensure to document (at a high-level) how the new design can handle custom settings in their php.ini and the use of PHP extensions.

**Database**

**Task:** How would you design a resilient and scalable MySQL backend configured to span geographically distributed datacenters and support an active-passive configuration?

**Network**

**Task:** How would you design a hybrid network (at a high-level) that will allow you to meet all the customer requirements and support your design for moving Trey Research to Azure?

1.  Design a virtual network in Azure and establish hybrid connectivity between Trey Research on-premises to Azure.

2.  Include Azure Networking features in the full design to ensure users connecting to the Web Application are routed to the front-end with the least number of hops. Ensure the load is balanced across these servers.

**DevOps in Azure implementation (Development)**

Use the features of Azure and the requirements to include Dropbox, Git, and Jenkins as a part of the solution. How would you design a DevOps pipeline workflow the Development team will use to move from Test, Staging, to Production? Make sure your design covers the following items:

**Task:** Document the workflow at a high-level to be used to implement a DevOps based Continuous Integration (CI) and Continuous Delivery/Deployment (CD) methodology at Trey Research.

1.  Where is code checked in, and how is the code built? Then, how does it deploy to the Site? Make sure to not only consider the in-house developers, but also the marketing vendors' code. Note that the marketing team is not going to move from using Dropbox.

2.  Design a "slotting" methodology using at least three slots for Test, Staging, and Production. How does code land on each of these sites? Show the full workflow from code check-in, build, deployment, and then promotion to production.

**Task:** How can Trey Research continue to use Eclipse as their development environment?

1.  Document how the tools are compatible with the new design.

2.  Determine how their client can debug issues. Can we debug our applications using Eclipse against Azure Web Apps?

3.  Document how Trey Research could build nonproduction Azure Web Apps that are "proof of concepts" so they can implement their alpha code directly to Azure, by-passing the CI/CD infrastructure

**Prepare**

Directions: With all participants at your table:

1.  Identify any customer needs that are not addressed with the proposed solution.

2.  Identify the benefits of your solution.

3.  Determine how you will respond to the customer's objections.

Prepare a 15-minute chalk-talk style presentation to the customer.

## Step 3: Present the solution

**Outcome**

Present a solution to the target customer audience in a 15-minute chalk-talk format.

Timeframe: 30 minutes

**Presentation**

Directions:

1.  Pair with another table.

2.  One table is the Microsoft team and the other table is the customer.

3.  The Microsoft team presents their proposed solution to the customer.

4.  The customer makes one of the objections from the list of objections.

5.  The Microsoft team responds to the objection.

6.  The customer team gives feedback to the Microsoft team.

7.  Tables switch roles and repeat Steps 2-6.

##  Wrap-up 

Timeframe: 15 minutes

Directions: Tables reconvene with the larger group to hear the facilitator/SME share the preferred solution for the case study.

##  Additional references
|    |            |       
|----------|:-------------:|
| **Description** | **Links** |
| Web Apps overview | <https://azure.microsoft.com/en-us/services/app-service/web/> |
| Web Apps Documentation | <https://azure.microsoft.com/en-us/documentation/articles/app-service-web-overview/> |
| Create a web app from the Azure Marketplace | <https://azure.microsoft.com/en-us/documentation/articles/app-service-web-create-web-app-from-marketplace/> |
| PHP Developer Center | <https://azure.microsoft.com/en-us/develop/php/> |
| Node Developer Center | <https://azure.microsoft.com/en-us/develop/nodejs/> |
| Configure PHP in Azure App Service Web Apps | <https://azure.microsoft.com/en-us/documentation/articles/web-sites-php-configure/> |
| Azure Toolkit for Eclipse | <https://azure.microsoft.com/en-us/documentation/articles/azure-toolkit-for-eclipse/> |
| Debugging Azure Applications in Eclipse | <https://azure.microsoft.com/en-us/documentation/articles/azure-toolkit-for-eclipse-debugging-azure-applications/> |
| Continuous deployment using GIT in Azure App Service | <https://azure.microsoft.com/en-us/documentation/articles/web-sites-publish-source-control/> |
| Azure Database for MySQL | <https://azure.microsoft.com/en-us/services/mysql/> |
| Overview of the Azure Content Delivery Network (CDN) | <https://azure.microsoft.com/en-us/documentation/articles/cdn-overview/> |
| Using Azure CDN | <https://azure.microsoft.com/en-us/documentation/articles/cdn-create-new-endpoint/> |
| Pre-load assets on an Azure CDN endpoint | <https://azure.microsoft.com/en-us/documentation/articles/cdn-preload-endpoint/> |
| Using Azure Storage with a Jenkins Continuous Integration solution | <https://azure.microsoft.com/en-us/documentation/articles/storage-java-jenkins-continuous-integration-solution/> |
| Jenkins and Azure | <https://jenkins.io/blog/2016/05/18/announcing-azure-partnership/> |
| Jenkins Pipeline | <https://jenkins.io/doc/pipeline/>  <https://github.com/jenkinsci/pipeline-plugin/blob/master/TUTORIAL.md/> |
| Dropbox & Jenkins | <https://wiki.jenkins-ci.org/display/JENKINS/Publish+over+Dropbox+Plugin/> |
| GitHub Enterprise in Azure Marketplace | <https://azure.microsoft.com/en-us/marketplace/partners/github/githubenterprise/> |
| Visual Studio Team Services | <https://www.visualstudio.com/team-services/> |
| Visual Studio Team Services Integration with Jenkins | <https://blogs.msdn.microsoft.com/devops/2017/04/25/vsts-visual-studio-team-services-integration-with-jenkins/> | Setting up CI / CD with the TFS Plugin for Jenkins | <http://donovanbrown.com/post/Setting-up-CICD-with-the-TFS-Plugin-for-Jenkins/> |


# OSS DevOps whiteboard design session trainer guide

## Step 1: Review the customer case study

-   Check in with your table participants to introduce yourself as the trainer.

-   Ask, "What questions do you have about the customer case study?"

-   Briefly review the steps and timeframes of the whiteboard design session.

-   Ready, set, go! Let the table participants begin.

## Step 2: Design a proof of concept solution

-   Check in with your tables to ensure that they are transitioning from step to step on time.

-   Provide some feedback on their responses to the business needs and design.

    -   Try asking questions first that will lead the participants to discover the answers on their own.

-   Provide feedback for their responses to the customer's objections.

    -   Try asking questions first that will lead the participants to discover the answers on their own.

## Step 3: Present the solution

-   Determine which table will be paired with your table before Step 3 begins.

-   For the first round, assign one table as the presenting team and the other table as the customer.

-   Have the presenting team present their solution to the customer team.

    -   Have the customer team provide one objection for the presenting team to respond to.

    -   The presentation, objections, and feedback should take no longer than 15 minutes.

    -   If needed, the trainer may also provide feedback.

## Wrap-up

-   Have the table participants reconvene with the larger session group to hear the facilitator/SME share the following preferred solution.

##  Preferred target audience

-   David Smith, CTO

-   Ursula Karalov, VP of Sales

-   Tim LaMar, Lead System Administrator

-   Development Leads

-   Operations Leads (includes networking)

-   Marketing Company Development Lead

## Preferred solution

Using the features of Azure and the requirements from the customer how would you design the application infrastructure and network for Trey Research while lowering the total cost of ownership of the entire solution by designing for the least complexity? Management/updating should be considered for the architecture. The use of VMs should be minimized to lessen the burden of management on the Operations team.

Make sure that your design covers the following items:

*Application*

The preferred solution for this design starts with the move from a single PHP and MySQL backend server to using PaaS (Platform as a Service) solutions from Azure in the form of Azure Web Apps. With the expansion to Asia, there will be a geo-distributed architecture in Europe and Asia using Azure networking features to ensure the best experience across the board for Trey Researches customers. Management is minimized with the deployment of the application taking advantage of Azure Web Apps and the database being hosted in Azure using Azure Database for MySQL.

**Task:** Design a scalable geo-distributed platform for the Trey Research web applications written in PHP, node.js, and WordPress.

**Answer:** By using Azure Web Apps in two regions, we can meet the needs of Trey Research. There will be a set of Web Apps deployed in the Azure Northern Europe Region and another in the South-East Asia Region, which is in Hong Kong SAR. By taking this approach, we are ensuring there will be web front ends close to current and future customers. Since Azure Web Apps support PHP, node.js, and WordPress, we can eliminate virtual machines for the website deployment.

**Task:** The solution should scale automatically and be resilient to failures.

**Answer:** Configuring web apps to scale is simple using Azure Web Apps. A set of criteria is easy to define and then Azure will take care of the hard work to ensure that the web app is always responsive. This set of steps is easily completed by administrators based on a few different metrics, such as CPU, memory, etc.

**Task:** Load times in locations around the world should be lessened as compared to today. Files should be placed as close to the user as possible.

**Answer:** Using the Azure CDN Standard or Premium from Verizon, we can pre-load files into nodes that are located closer to customers. This ensures that the load times for static content will be less than if they were served directly by the web application. All static content will be preloaded, including images and PDFs among other items on the site.

**Task:** Ensure to document (at a high level) how the new design can handle custom settings in their php.ini and the use of PHP extensions.

**Answer:** The administrator should create a ". user.ini" file in the root of the web app using Kudu and then create settings just as you would in the php.ini file of a Linux box. For the extensions, add a 'ext.' directory to the d:\\home\\site directory on the web app and the put .dll extension files into the ext. directory.

*Database*

**Task:** How would you design a resilient and scalable MySQL backend configured to span geographically distributed datacenters and support an active-passive configuration?

**Answer:** By creating the Web App On Linux + MySQL, Trey Research can select Azure Database for MySQL as the MySQL provider for this application. It also has built-in high availability and requires no extra configuration, replication, or cost to ensure that the apps run when you need them to.

*Network*

**Task:** How would you design a hybrid network (at a high-level) that will allow you to meet all the customer requirements and support your design for moving Trey Research to Azure?

**Answer:** Using a site-to-site VPN between their corporate location and the Northern Europe Azure Region, the networks will be connected privately (hybrid cloud connectivity). The Jenkins Master and agent nodes along with a new GitHub Enterprise server will be implemented in the VNET in Azure North Europe. It will allow for the use of bursting the number of Jenkins agent nodes on demand and ensure 99.95% update based on the Azure SLA.

**Task:** Design a virtual network in Azure and establish hybrid connectivity between Trey Research on premise to Azure.

**Answer:** Site-to-site VPN from corporate location to Azure Northern Europe. Various options are available to enable different amounts of bandwidth and degrees of resiliency.

**Task:** Include Azure Networking features in the design to ensure users connecting to the Web Application are routed to the front-end with the least number of hops. Ensure that the load is balanced across these servers.

**Answer:** Traffic Manager should be implemented to route DNS traffic to the either of the Azure regions based on Performance or Geography. Performance will calculate the number of hops between the user and each of the Azure Web App frontends and direct the traffic to the one with the least number of hops. The Geography routing method directs users to endpoints in their geographic region. Since Azure Web Apps automatically manage the Load Balancer for the application, no additional configuration is required. To ensure that static content loads as quickly as possible, the Azure CDN will be taken advantage of. By placing static content such as site pictures and PDFs on CDN endpoints, users will receive the best loading experience possible.

![A diagram that depicts a web based solution deployed in two regions with Azure Traffic Manager directing traffic to the closest one. In front of the web app is Azure CDN. The database is Azure Database for MySQL configured for geo-restore. GitHub and Jenkins are depicted running in Azure using virtual machines. ](images/Whiteboarddesignsessiontrainerguide-OSSDevOpsimages/media/image5.png "Preferred solution")

*Additional solution*

![A diagram that depicts a web based solution deployed in two regions with Azure Traffic Manager directing traffic to the closest one. In front of the web app is Azure CDN. The database is Azure Database for MySQL configured for geo-restore. Visual Studio Team Services is shown next to GitHub enterprise.](images/Whiteboarddesignsessiontrainerguide-OSSDevOpsimages/media/image6.png "Additional solution")

This is an additional solution that simplifies the Azure environment by integrating (or completely replacing) the Jenkins infrastructure with Visual Studio Team Services, thereby reducing the management overhead since there would be no servers to manage in this solution.

Visual Studio Team Services Integration with Jenkins

VSTS includes a growing list of preinstalled configurations. One of its integrations is with Jenkins. This allows using both CI systems with traceability through a single platform. Some example scenarios include:

-   Using Jenkins for continuous integration of Team Services Git repositories.

-   Using Jenkins to validate Team Service pull requests.

-   Mixing Jenkins and Team Services to perform builds and releases.

-   Providing traceability between Jenkins and Team Services; linking builds, pull requests, commits, and stories.

There are multiple ways to use Jenkins as a CI server with Team Services. Jenkins' built-in Git Plugin can poll a VSTS repository every few minutes and queue a job when changes are detected. For those who need a tighter integration, VSTS provides two additional ways to achieve it: 1) The Jenkins Service Hook, and 2) Jenkins build and release tasks.

The Jenkins Service Hook in VSTS automatically queues a Jenkins job when code changes are pushed to your repository. This is an improvement over polling because jobs are immediately queued.

VSTS adds capabilities over the Jenkins Service Hook by including connectors that allow its build and release systems to integrate with Jenkins. These connectors can be chosen from the list of tasks to execute as steps in a VSTS build or release definition.

In effect, a VSTS build or release will queue a Jenkins job and download resulting artifacts. The Jenkins Queue Job task queues a Jenkins job by name. It can wait for the job to complete or immediately continue to subsequent steps.

When the option is selected to capture the Jenkins job's console output, it is displayed live in VSTS while the build executes. After the build completes, the console output is available in the VSTS logs.

Downstream jobs and multi-branch pipeline results are displayed in the Team Services Build or Release Summary for traceability.

The Jenkins Download Artifacts task makes it easy to download build artifacts from Jenkins and integrate them in your VSTS build or release process. Once artifacts are downloaded, they can be used by other tasks.

Jenkins can also independently trigger a VSTS release. You can configure the Jenkins post-build action named Trigger release in TFS / Team Services to initiate the release.

Then, you can set your VSTS release definition to use artifacts from the Jenkins build. Artifacts will be downloaded from Jenkins and used in your VSTS release pipeline.

Alternatively, you could simply replace your Jenkins installation and use the end-to-end features all within Visual Studio Team Services using the built-in tasks to build and deploy the solution.

*DevOps in Azure implementation (Development team)*

Use the features of Azure and the requirements to include Dropbox, Git, and Jenkins as a part of the solution. How would you design a DevOps pipeline workflow the Development team will use to move from Test, Staging, to Production? Make sure your design covers the following items:

**Task:** Document the workflow (at a high-level) that will be used to implement a DevOps based Continuous Integration (CI) and Continuous Delivery/Deployment (CD) methodology at Trey Research.

**Answer:** Code will be checked into GitHub and content will be placed in Dropbox. These updates will be picked up by Jenkins and built, and then it will be copied to the infrastructure using the Azure CLI.

**Task:** Where is the code checked in? How does the code get built and then how does it deploy to the site? Make sure to not only consider the in-house developers, but also the marketing vendors' code. Note that the marketing team is not going to move from using Dropbox.

**Answer:** Code will be checked into GitHub. Content will be placed in Dropbox and then it will be picked up by the Jenkins plugins before being moved through a custom pipeline in Jenkins to build the code and make any other transformations required for its deployment. Once this process has been completed, Jenkins will then use the custom bash scripts calling the Azure CLI to move the files into place across the Azure Web App and CDN endpoints.

![The Preferred solution for CI and CD workflow are as previously described.](images/Whiteboarddesignsessiontrainerguide-OSSDevOpsimages/media/image7.png "Preferred solution CI and CD workflow")

**Task:** Design a slotting methodology using at least three slots for Test, Staging, and Production. How does code land on each of these sites? Show the full workflow from code check-in, build, deployment, and then promotion to production.

**Answer:** Once codes goes through the process, it will land on the test slot of the web app. The code will then be accessible via the URL that is created by Azure: <http://treyresearch-test.azurewebsites.net>. From there the testers will be able to review the site to ensure that it is ready to move to productions. Much of this testing should be automated to improve deployment times and reduce errors. In DevOps, Testing is not a stage, but an ongoing part of the process at each stage. Once testing has completed, it will then be promoted to the staging slot at <http://treyreasearh-staging.azurewebsites.net>. It can then be swapped into production.

![The Preferred solution for CI, CD Azure slots workflow is as previously described.](images/Whiteboarddesignsessiontrainerguide-OSSDevOpsimages/media/image8.png "The Preferred solution for CI, CD Azure slots workflow")

**Task:** Document how Trey Research can continue to use Eclipse as their development environment. Document how the tools are compatible with the new design.

**Answer:** Eclipse is supported for use with Azure Web Apps in Azure by using the Azure Toolkit for Eclipse.

**Task:** Determine how their client can debug issues. Can we debug our applications using Eclipse against Azure Web Apps?

**Answer:** Azure Web Apps support the connection of the Eclipse environment directly to debug applications.

**Task:** Document how Trey Research could build non-production Azure Web Apps that are proof of concepts, so they can implement their alpha code directly to Azure by-passing the CI/CD infrastructure.

**Answer:** Trey Research can create separate Azure Web Apps that are not a part of the production sites. Using the Eclipse environment including the Azure Toolkit, the developers can publish their site directly from Eclipse. It allows for them to do proof of concepts without having to do the full integration Git and Jenkins. It will ensure a fast start for these projects and the Development team can do it without involving the Operations team.

## Checklist of preferred objection handling

1.  Why use Microsoft Azure? Surely, Azure is a Windows only cloud because Microsoft sells the Windows operating system.

    **Potential Answer:** Azure is an open source friendly cloud that supports PHP, node.js, WordPress, and MySQL among many other OSS projects. There is no reason to believe that Microsoft is Windows-only focused anymore. Microsoft has open sourced many of their closest held products to include .NET, ASP.NET, and all of the Azure SDKs and client tools. In addition, Microsoft has joined the Open Compute Project and the Eclipse foundation.

2.  What does Microsoft know about PHP and the LAMP stack? They cannot offer support of these things, whereas I know other companies that have successful deployments of this on Amazon.

    **Potential Answer:** Microsoft has supported PHP and the entire LAMP stack on Azure from the beginning of both the PaaS and IaaS services. There is full support for these products.

3.  If we move to the cloud, will we always be ready to take our customers' orders?

    **Potential Answer:** Moving to the cloud should never be seen as a panacea to application or operations issue. However, Azure has exponentially reduced the complexity of integrating redundancy and content acceleration into common workloads. The platform has made resilient deployments approachable for all types of businesses from a cost perspective.

4.  We have a few settings in our php.ini and some of the applications use PHP extensions, which are critical to their functionality. Can we make custom settings and enable extensions like this if we use Azure Web Apps?

    **Potential Answer:** Microsoft supports the ability to add settings to the php.in files and enable PHP extensions. It will not be an obstacle in moving to Azure Web Apps.

5.  We primarily use Eclipse for our development, which is what our team uses to debug issues. Can we debug our applications using Eclipse against Azure Web Apps?

    **Potential Answer:** The Azure Toolkit for Eclipse allows for both the publishing and debugging of applications directly on Azure Web Apps. Trey Research should be able to continue to use the Eclipse toolset easily.

6.  We simply cannot move to Microsoft SQL Server; we do not want to deal with the issues of the MySQL VMs anymore.

    **Potential Answer:** It is not an issue as Azure supports Azure Database for MySQL as a Platform as a Service (PaaS) offering.

## Customer quote (to be read back to the attendees at the end)

*"By using Azure PaaS Services, Azure Database for MySQL, and multiple regions we are now able to both scale and support our CI/CD needs. Using the images from the Azure Market Place for Jenkins and GitHub Enterprise allowed for a rapid migration to Azure."*

---David Smith, CTO, Trey Research
